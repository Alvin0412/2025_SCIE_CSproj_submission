import{b as e,c as t,d as n}from"./formErrors-BvVk0124.js";import{b as r}from"./input-DJ2R0PPV.js";import{b as i}from"./css-Kk413bhP.js";import{ap as a,ay as o,az as s,b$ as c,b2 as l,b8 as u,b9 as d,bC as f,bE as p,bJ as m,bL as h,bS as g,ba as _,bb as v,bc as y,bd as b,be as x,bg as S,bh as C,bi as w,bt as T,bv as E,bx as D,c0 as O,d as k,e as A,f as j,g as M}from"./index-BCk1CcfA.js";/* empty css            */const N={class:`min-h-screen flex items-center justify-center bg-gradient-to-br from-indigo-50 to-white`},P={class:`w-full max-w-lg mx-auto bg-white/95 backdrop-blur px-10 py-12 rounded-3xl shadow-2xl border border-indigo-100`},F={class:`text-left text-sm`},I={class:`grid grid-cols-1 md:grid-cols-2 gap-4`},L={key:0,class:`mt-3 flex items-center gap-3 text-sm`},R={class:`text-sm text-center text-slate-500 mt-6`};var z=w({__name:`Register`,setup(w){let k=a(),{isAuthenticating:z}=l(k),B=s(),V=o(),H=[`first_name`,`last_name`,`email`,`password`],U=h(),W=m({first_name:``,last_name:``,email:``,password:``}),G=m({first_name:``,last_name:``,email:``,password:``}),K=h([]),q=_(()=>V.query.redirect||`/search`),J={first_name:[{required:!0,message:`First name is required`,trigger:`blur`}],last_name:[{required:!0,message:`Last name is required`,trigger:`blur`}],email:[{required:!0,message:`Email is required`,trigger:`blur`},{type:`email`,message:`Invalid email`,trigger:`blur`}],password:[{required:!0,message:`Password is required`,trigger:`blur`},{min:8,message:`Password must be at least 8 characters`,trigger:`blur`}]},Y=_(()=>{let e=W.password;if(!e)return{score:0,label:`Weak`,color:`#f87171`};let t=0;e.length>=8&&(t+=1),e.length>=12&&(t+=1),/[A-Z]/.test(e)&&(t+=1),/[0-9]/.test(e)&&(t+=1),/[^A-Za-z0-9]/.test(e)&&(t+=1);let n=Math.min(t/5*100,100),r=`Weak`,i=`#f97316`;return t>=4?(r=`Strong`,i=`#22c55e`):t===3&&(r=`Good`,i=`#3b82f6`),{score:n,label:r,color:i}}),X=()=>{H.forEach(e=>{G[e]=``}),K.value=[]};H.forEach(e=>{f(()=>W[e],()=>{G[e]&&(G[e]=``),K.value.length&&(K.value=[])})});let Z=async()=>{if(U.value)try{X(),await U.value.validate(),await k.register({...W});let e=k.roles[0]?.name??`Viewer`;A.success(`Account created · Assigned role: ${e}`),B.replace(q.value)}catch(t){let n=e(t);H.forEach(e=>{G[e]=n.fieldErrors[e]??``}),n.nonFieldErrors.length?K.value=n.nonFieldErrors:Object.values(n.fieldErrors).some(Boolean)||A.error(`Failed to create your account. Please try again.`)}};return(e,a)=>{let o=D(`router-link`);return T(),x(`div`,N,[v(`div`,P,[a[7]||=v(`div`,{class:`text-center mb-10`},[v(`h1`,{class:`text-3xl font-semibold text-slate-900`},`Create your account`),v(`p`,{class:`text-sm text-slate-500 mt-2`},`Join PastPaperRank to unlock AI search and RBAC tools.`)],-1),C(g(t),{ref_key:`formRef`,ref:U,model:W,rules:J,"label-position":`top`,class:`space-y-4`,onSubmit:u(Z,[`prevent`])},{default:p(()=>[K.value.length?(T(),y(g(i),{key:0,class:`mb-2`,type:`error`,closable:!1,"show-icon":``},{default:p(()=>[v(`ul`,F,[(T(!0),x(d,null,E(K.value,e=>(T(),x(`li`,{key:e},O(e),1))),128))])]),_:1})):b(``,!0),v(`div`,I,[C(g(n),{label:`First name`,prop:`first_name`,error:G.first_name},{default:p(()=>[C(g(r),{modelValue:W.first_name,"onUpdate:modelValue":a[0]||=e=>W.first_name=e,size:`large`,placeholder:`Ada`,autocomplete:`given-name`,disabled:g(z)},null,8,[`modelValue`,`disabled`])]),_:1},8,[`error`]),C(g(n),{label:`Last name`,prop:`last_name`,error:G.last_name},{default:p(()=>[C(g(r),{modelValue:W.last_name,"onUpdate:modelValue":a[1]||=e=>W.last_name=e,size:`large`,placeholder:`Lovelace`,autocomplete:`family-name`,disabled:g(z)},null,8,[`modelValue`,`disabled`])]),_:1},8,[`error`])]),C(g(n),{label:`Email`,prop:`email`,error:G.email},{default:p(()=>[C(g(r),{modelValue:W.email,"onUpdate:modelValue":a[2]||=e=>W.email=e,size:`large`,type:`email`,placeholder:`you@example.com`,autocomplete:`email`,disabled:g(z)},null,8,[`modelValue`,`disabled`])]),_:1},8,[`error`]),C(g(n),{label:`Password`,prop:`password`,error:G.password},{default:p(()=>[C(g(r),{modelValue:W.password,"onUpdate:modelValue":a[3]||=e=>W.password=e,size:`large`,type:`password`,placeholder:`••••••••`,"show-password":``,autocomplete:`new-password`,disabled:g(z)},null,8,[`modelValue`,`disabled`]),W.password?(T(),x(`div`,L,[C(g(j),{percentage:Y.value.score,color:Y.value.color,"stroke-width":6,"show-text":!1,class:`flex-1`},null,8,[`percentage`,`color`]),v(`span`,{class:`font-medium`,style:c({color:Y.value.color})},O(Y.value.label),5)])):b(``,!0)]),_:1},8,[`error`]),C(g(M),{type:`primary`,size:`large`,class:`w-full`,loading:g(z),disabled:g(z),"native-type":`submit`},{default:p(()=>a[4]||=[S(` Create account `,-1)]),_:1,__:[4]},8,[`loading`,`disabled`])]),_:1},8,[`model`]),v(`p`,R,[a[6]||=S(` Already have an account? `,-1),C(o,{to:`/login`,class:`text-indigo-600 font-medium`},{default:p(()=>a[5]||=[S(`Sign in`,-1)]),_:1,__:[5]})])])])}}}),B=k(z,[[`__scopeId`,`data-v-42a9eb14`]]);export{B as default};