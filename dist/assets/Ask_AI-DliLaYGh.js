import{b as e}from"./input-DJ2R0PPV.js";import{b as t}from"./tag-CooYrMrP.js";import{ap as n,az as r,b8 as i,b9 as a,bC as o,bE as s,bL as c,bS as l,bZ as u,ba as d,bb as f,bc as p,bd as m,be as h,bg as g,bh as _,bi as ee,bp as te,bq as ne,br as re,bt as v,bv as y,c0 as b,d as x}from"./index-BCk1CcfA.js";/* empty css            *//* empty css            */import{b as ie}from"./SideNavbar-CHqNkm4k.js";import"./css-zdK3R9k8.js";const ae={class:`flex h-screen bg-slate-50 font-sans`},oe={class:`flex flex-1 flex-col min-w-0`},se={class:`flex flex-col gap-3 border-b border-slate-200 bg-white px-4 py-4 md:flex-row md:items-center md:justify-between md:px-6`},ce={class:`flex flex-wrap items-center gap-3`},le={class:`text-xs text-slate-500`},ue={class:`inline-flex rounded-lg bg-slate-100 px-2 py-1 font-mono text-[11px] text-slate-700`},de={class:`flex gap-2`},fe=[`disabled`],pe=[`disabled`],me={class:`flex flex-1 overflow-hidden`},he={class:`flex flex-1 flex-col bg-slate-50/80`},ge={class:`flex-1 overflow-hidden`},_e={key:0,class:`mx-auto mt-20 max-w-lg text-center text-sm text-slate-500`},ve={class:`flex flex-wrap items-center gap-2 text-[11px] font-semibold uppercase tracking-wide`},ye={class:`font-normal normal-case text-slate-400`},be={key:0,class:`rounded-full bg-amber-100 px-2 py-0.5 text-[10px] font-semibold text-amber-700`},xe={key:1,class:`rounded-full bg-amber-100 px-2 py-0.5 text-[10px] font-semibold text-amber-700`},Se={key:2,class:`rounded-full bg-rose-100 px-2 py-0.5 text-[10px] font-semibold text-rose-700`},Ce={key:0,class:`mt-4 space-y-3`},we={class:`flex flex-wrap items-start justify-between gap-3`},Te={class:`text-sm font-semibold text-slate-900`},Ee={class:`text-xs text-slate-500`},De={class:`score-chip`},Oe={class:`mt-3 text-sm text-slate-700`},ke={class:`mt-3 flex flex-wrap gap-2 text-xs text-slate-600`},Ae={key:0,class:`mt-2 text-xs text-slate-500`},je={class:`border-t border-slate-200 bg-white px-4 py-4 md:px-10`},Me={class:`rounded-2xl border border-amber-200 bg-amber-50 px-4 py-3 text-sm text-amber-800`},Ne={class:`flex items-center justify-end gap-2`},Pe=[`disabled`],Fe={class:`flex flex-wrap items-center justify-between gap-3`},Ie={class:`flex flex-wrap gap-2`},Le=[`onClick`],Re={class:`flex items-center gap-2`},ze=[`disabled`],Be=[`disabled`],Ve={key:2,class:`mt-3 text-xs text-slate-500`},He={key:3,class:`mt-1 text-xs text-amber-600`},Ue={key:4,class:`mt-2 text-xs text-rose-600`},We={class:`hidden w-96 flex-col gap-4 overflow-y-auto border-l border-slate-200 bg-white p-6 lg:flex`},Ge={class:`card space-y-3`},Ke={class:`flex items-center justify-between gap-2`},qe={class:`break-all rounded-xl bg-slate-100 px-3 py-2 text-xs text-slate-600`},Je={class:`flex gap-2`},Ye=[`disabled`],Xe=[`disabled`],Ze={key:0,class:`rounded-xl bg-rose-50 px-3 py-2 text-xs text-rose-600`},Qe={class:`card space-y-3`},$e={class:`flex items-center justify-between gap-2`},et={class:`text-xs font-medium text-slate-500`},tt={class:`space-y-2 text-sm text-slate-600`},nt={class:`flex justify-between gap-3`},rt={class:`text-right text-slate-700`},it={class:`flex justify-between gap-3`},at={class:`text-right text-slate-700`},ot={key:0,class:`flex justify-between gap-3`},st={class:`text-right text-slate-700`},ct={key:0,class:`rounded-2xl bg-slate-50 px-3 py-3 text-xs text-slate-600`},lt={class:`space-y-1`},ut={class:`font-semibold text-slate-500`},dt={key:1,class:`rounded-xl bg-slate-100 px-3 py-2 text-xs text-slate-600`},ft={class:`card flex flex-col gap-3`},pt={class:`flex items-center justify-between gap-2`},mt=[`disabled`],ht={class:`flex-1 space-y-3 overflow-auto pr-1`},gt={key:0,class:`text-sm text-slate-500`},_t={class:`mt-1`},vt={class:`flex-1`},yt={class:`flex flex-wrap items-center justify-between gap-2`},bt={class:`text-sm font-semibold text-slate-900`},xt={class:`text-xs text-slate-400`},St={class:`mt-1 text-sm text-slate-600 whitespace-pre-line`},S=50;var C=ee({__name:`Ask_AI`,setup(ee){let x=[`Find recent IGCSE chemistry questions about mole concept and stoichiometry.`,`The final (hardest) question from the IGCSE Mathematics 2019 October/November exam.`,`A-Level Physics electromagnetic induction problems with mark schemes.`],C=c(``),w=c(null),T=c(``),E=c(!1),D=c([]),O=c([]),k=c(null),A=c(null),j=c(null),M=c(`idle`),N=c(``),P=c([]),F=c(``),I=c(``),L=c(``),R=kt(),z=c([]),B=c(null),V=c(null),H=c(!1),U=n(),W=d(()=>E.value?`connecting`:w.value?.readyState===WebSocket.OPEN?`connected`:`disconnected`),G=d(()=>{switch(W.value){case`connected`:return`border-emerald-200 bg-emerald-50 text-emerald-700`;case`connecting`:return`border-amber-200 bg-amber-50 text-amber-700`;default:return`border-slate-200 bg-slate-50 text-slate-600`}}),Ct=d(()=>{switch(M.value){case`running`:return`Running retrieval…`;case`awaiting_clarify`:return`Awaiting clarification`;case`complete`:return`Completed`;case`error`:return`Encountered an error`;default:return`Idle`}}),K=d(()=>M.value===`awaiting_clarify`),q=d(()=>W.value===`connected`&&!!T.value&&!!C.value.trim()&&M.value!==`running`&&!K.value),wt=d(()=>T.value||`—`),Tt=d(()=>K.value?`Add extra detail so I can continue…`:`Describe the past paper content you need…`),Et=d(()=>!!I.value.trim()),Dt=d(()=>M.value===`running`&&!K.value&&W.value===`connected`&&!!T.value&&!H.value),Ot=r();re(async()=>{if(!U.user)try{await U.fetchSelf()}catch{}if(U.user?.plan_required){Ot.replace({name:`plan`,query:{redirect:`ask-ai`}});return}J()}),ne(()=>{Y(),w.value?.close()}),o(z,async()=>{await te();let e=V.value;e&&(e.scrollTop=e.scrollHeight)},{deep:!0});function kt(){if(typeof window<`u`){let e=window.location.protocol===`https:`?`wss`:`ws`;return`${e}://${window.location.host}/ws/retrieval/`}return`/ws/retrieval/`}function J(){try{w.value&&(Y(),w.value.close()),T.value=``,E.value=!0,L.value=``;let e=new WebSocket(R);w.value=e,e.addEventListener(`open`,()=>{E.value=!1,e.send(JSON.stringify({action:`subscribe`})),H.value=!1}),e.addEventListener(`message`,e=>{let t;try{t=JSON.parse(e.data)}catch{console.warn(`[AskAI] Failed to parse websocket message:`,e.data);return}if(t?.type===`subscribed`&&t.rid){T.value=t.rid,M.value=`idle`;return}let n=t?.type===`progress`||typeof t?.event==`string`||typeof t?.event==`object`||t?.data&&typeof t.data==`object`&&`event`in t.data;if(n){console.info(`[AskAI] Progress frame received:`,t);try{Rt(t)}catch(e){console.error(`[AskAI] Failed to process progress payload:`,t,e)}return}t?.type===`error`&&(L.value=t?.error||`Realtime server error`,M.value=`error`,Z({status:`error`,content:L.value}),console.error(`[AskAI] Error frame received:`,t))}),e.addEventListener(`error`,()=>{L.value=L.value||`Unable to reach realtime endpoint.`,!E.value&&(M.value=`error`,Z({status:`error`,content:L.value})),console.error(`[AskAI] WebSocket encountered an error`)}),e.addEventListener(`close`,()=>{let t=e?._manualClose;w.value===e&&(w.value=null,T.value=``),!t&&M.value===`running`&&(M.value=`error`,L.value=L.value||`Connection closed unexpectedly.`,Z({status:`error`,content:L.value}),console.warn(`[AskAI] WebSocket closed unexpectedly while running`)),E.value=!1,H.value=!1})}catch(e){E.value=!1,L.value=e instanceof Error?e.message:String(e)}}function Y(){w.value&&(w.value.readyState===WebSocket.OPEN&&T.value&&w.value.send(JSON.stringify({action:`unsubscribe`,rid:T.value})),w.value._manualClose=!0)}function At(){w.value&&(Y(),w.value.close(),w.value=null,T.value=``,M.value=`idle`,H.value=!1)}function jt(){w.value?.readyState===WebSocket.OPEN&&w.value.send(JSON.stringify({action:`ping`}))}function Mt(){!Dt.value||!w.value||w.value.readyState!==WebSocket.OPEN||!T.value||(w.value.send(JSON.stringify({action:`stop`,rid:T.value})),H.value=!0,$(`Stop requested`,`User stopped the current retrieval run.`),Z({status:`pending`,content:`Stopping the search…`}))}function X(e,t,n={}){let r={id:`${e}-${Date.now()}-${Math.random().toString(36).slice(2,8)}`,role:e,content:t,ts:Date.now(),status:n.status,results:n.results,meta:n.meta};return z.value=[...z.value,r],r}function Nt(e=`Working on it…`){let t=X(`assistant`,e,{status:`pending`,results:[]});B.value=t.id}function Z(e){if(!B.value)return;let t=z.value.findIndex(e=>e.id===B.value);if(t===-1)return;let n=z.value[t];z.value.splice(t,1,{...n,...e,results:e.results??n.results,status:e.status??n.status,content:e.content??n.content,ts:e.ts??n.ts}),e.status&&e.status!==`pending`&&(B.value=null)}function Pt(e){if(!e.length)return`I couldn’t find matching problems for that query.`;let t=e[0],n=[t.subject||null,t.paper_code||null,t.year?`(${t.year})`:null].filter(Boolean),r=n.length?n.join(` `):`a relevant problem`;return e.length===1?`I found ${r}.`:`Here are ${e.length} promising problems. The top match is ${r}.`}async function Ft(){try{await U.fetchSelf()}catch(e){return L.value=`Unable to verify your subscription. Please try again.`,M.value=`error`,console.error(`[AskAI] Failed to refresh subscription status`,e),!1}return U.user?.plan_required?(L.value=`Your subscription is inactive. Please activate a plan to use Ask AI.`,M.value=`idle`,!1):!0}async function It(){if(!q.value)return;let e=C.value.trim();if(!e)return;let t=await Ft();t&&(M.value=`running`,O.value=[],D.value=[],k.value=null,A.value=null,j.value=null,L.value=``,N.value=e,P.value=[{role:`user`,content:e}],X(`user`,e),Nt(`Let me check that for you…`),F.value=``,I.value=``,H.value=!1,Q(e),C.value=``)}function Q(e){if(!w.value||w.value.readyState!==WebSocket.OPEN||!T.value){L.value=`Realtime channel is not ready.`,M.value=`error`,Z({status:`error`,content:L.value});return}w.value.send(JSON.stringify({action:`start`,rid:T.value,query:e,options:{limit:8,keyword_limit:20,semantic_limit:15,conversation:P.value}}))}async function Lt(){if(!K.value)return;let e=I.value.trim();if(!e)return;let t=await Ft();t&&(P.value.push({role:`user`,content:e}),X(`user`,e),$(`Clarification sent`,e),I.value=``,M.value=`running`,Nt(`Thanks! Searching again…`),H.value=!1,Q(N.value))}function Rt(e){let t=typeof e.event==`object`&&e.event!==null?e.event:null,n=t?.status??e.status??`message`,r=[e.data&&typeof e.data==`object`?e.data:null,t&&typeof t.data==`object`?t.data:null,t&&typeof t==`object`?t:null],i=r.find(e=>e&&Object.keys(e).length>0),a={...i||{}},o=[`event`,`reason`,`action`,`prompt`,`message`,`detail`,`workspace`,`results`,`blueprint`,`round`,`returned`,`new`];for(let[t,n]of Object.entries(e)){if([`type`,`rid`,`status`,`seq`,`ts`,`data`,`event`,`event_type`,`label`,`detail`,`results`].includes(t))continue;a[t]===void 0&&(o.includes(t)||typeof n!=`object`)&&(a[t]=n)}e.results&&a.results===void 0&&(a.results=e.results),typeof a.event!=`string`&&(a.event=typeof t?.event==`string`&&t.event||typeof e.event==`string`&&e.event||typeof e.event_type==`string`&&e.event_type||void 0);let s=typeof a.event==`string`&&a.event||(typeof n==`string`?n:`message`),c=s||`message`;console.info(`[AskAI] Normalized progress event:`,{status:n,event:c,data:a,raw:e});let l=zt(c,a,e),u=typeof t?.label==`string`&&t.label||typeof e.label==`string`&&e.label||l.label,d=typeof t?.detail==`string`&&t.detail||typeof e.detail==`string`&&e.detail||l.detail,f={id:String(t?.seq??e.seq??`${c}-${Date.now()}`),ts:(typeof e.ts==`number`?e.ts:void 0)??(typeof t?.ts==`number`?t.ts:void 0)??Date.now()/1e3,status:n??`message`,eventType:c,label:u,detail:d,data:a};D.value=[f,...D.value].slice(0,S);let p;if(Array.isArray(a.results)?p=a.results:Array.isArray(e.results)?p=e.results:Array.isArray(t?.results)&&(p=t.results),p&&p.length&&(O.value=p),c===`intent`&&a.blueprint&&(k.value=a.blueprint),(c===`round_start`||c===`blueprint_refined`)&&a.blueprint&&(k.value=a.blueprint),(c===`keyword_pass`||c===`semantic_pass`||c===`round_summary`)&&a.workspace&&(A.value=a.workspace),n===`started`&&M.value!==`awaiting_clarify`&&(M.value=`running`),c===`safeguard`){let t=a.reason||e.msg||`A safeguard was triggered.`;L.value=t,Z({status:`error`,content:t}),a.action===`clarify`?(M.value=`awaiting_clarify`,F.value=t,P.value.push({role:`assistant`,content:t})):M.value=`error`,H.value=!1;return}if(c===`clarify`){M.value=`awaiting_clarify`,F.value=a.prompt||`Please add more detail so we can continue.`,P.value.push({role:`assistant`,content:F.value}),Z({status:`awaiting`,content:F.value}),H.value=!1;return}if(c===`user_stop`){H.value=!0,Z({status:`pending`,content:`Stopping the search…`});return}let m=n===`error`||c===`error`||c===`concurrency_limit`,h=c===`stopped`||c===`stop`,g=c===`complete`||c===`stopped`||n===`finished`||c===`result`&&Array.isArray(p);if(g){let e=p??O.value;O.value=e,A.value=a.workspace_summary||A.value,j.value=a.rerank_provenance||j.value,M.value=`complete`;let t=H.value||c===`stopped`;e.length>0?Z({status:`complete`,content:t?`Stopped the search early. Here’s what I found so far.`:Pt(e),results:e}):Z({status:`complete`,content:t?`Stopped the search.`:`I couldn’t find matching problems for that query.`,results:[]}),H.value=!1;return}if(m){M.value=`error`,L.value=a.error||a.detail||t?.error||e.msg||(typeof t?.message==`string`?t.message:``)||`Retrieval failed.`,Z({status:`error`,content:L.value}),H.value=!1;return}if(h){M.value=`idle`,H.value=!1,Z({status:`complete`,content:`Okay, I’ve stopped that retrieval run.`,results:O.value});return}let _=typeof a.message==`string`&&a.message||typeof e.msg==`string`&&e.msg||typeof t?.message==`string`&&t.message;_&&B.value&&Z({content:_}),console.info(`[AskAI] Event processed`,{event:c,runState:M.value,stopRequested:H.value,results:O.value.length})}function zt(e,t,n){let r={started:`Run started`,intent:`Intent parsed`,intent_fallback:`Intent fallback`,safeguard:`Safeguard`,clarify:`Clarification requested`,round_start:`Round started`,keyword_pass:`Keyword retrieval`,semantic_pass:`Semantic retrieval`,round_summary:`Round summary`,blueprint_refined:`Blueprint refined`,refine_fallback:`Refiner fallback`,rerank_fallback:`Rerank fallback`,complete:`Retrieval complete`,concurrency_limit:`Concurrency limit`,user_stop:`Stopping current run`,stop:`Run stopped`,stopped:`Run stopped`,error:`Error`},i=typeof n.status==`string`?n.status:``,a=r[e]||(i?r[i]:void 0)||`Update`,o;switch(e){case`intent`:{let e=t.blueprint||{},n=[e.subject?`Subject: ${e.subject}`:null,e.exam_board?`Board: ${e.exam_board}`:null,e.resource_type?`Resource: ${e.resource_type}`:null].filter(Boolean);Array.isArray(e.keywords)&&e.keywords.length&&n.push(`Keywords: ${e.keywords.join(`, `)}`),o=n.join(` · `);break}case`keyword_pass`:case`semantic_pass`:o=`${e===`keyword_pass`?`Keyword`:`Semantic`} pass returned ${t.returned??0} candidates (${t.new??0} new, workspace total ${t.workspace&&t.workspace.total||0}).`;break;case`round_summary`:if(t.workspace){let e=t.workspace.total??0,n=t.workspace.avg_score??`—`;o=`Workspace has ${e} candidates (avg score ${n}).`}break;case`blueprint_refined`:o=`${t.action||`adjusted`} · ${t.reason||`Blueprint updated`}`;break;case`clarify`:o=t.prompt;break;case`rerank_fallback`:case`refine_fallback`:case`intent_fallback`:o=t.reason;break;case`safeguard`:o=`${(t.action||``).toUpperCase()}: ${t.reason||`Policy triggered`}`;break;case`complete`:o=`Delivered ${t.results&&t.results.length||0} results after ${t.rounds_completed||1} round(s).`;break;case`user_stop`:o=`Client requested the current run to stop.`;break;case`stop`:case`stopped`:o=`Retrieval cancelled by the client.`;break;case`concurrency_limit`:o=t.detail||`Too many concurrent searches.`;break;default:o=n.msg}return{label:a,detail:o}}function $(e,t){let n={id:`client-${Date.now()}`,ts:Date.now()/1e3,status:`message`,eventType:`client`,label:e,detail:t};D.value=[n,...D.value].slice(0,S)}function Bt(e){return e?new Date(e*1e3).toLocaleTimeString([],{hour:`2-digit`,minute:`2-digit`,second:`2-digit`}):``}function Vt(e){return e?new Date(e).toLocaleTimeString([],{hour:`2-digit`,minute:`2-digit`}):``}function Ht(e){return e.status===`error`||e.eventType===`error`||e.eventType===`safeguard`?`border-rose-200 bg-rose-50 text-rose-600`:e.eventType===`complete`?`border-emerald-200 bg-emerald-50 text-emerald-700`:e.eventType===`clarify`?`border-amber-200 bg-amber-50 text-amber-700`:`border-slate-200 bg-slate-50 text-slate-600`}function Ut(){D.value=[]}function Wt(e){K.value?I.value=e:C.value=e}return(n,r)=>(v(),h(`div`,ae,[_(ie,{class:`hidden md:flex`}),f(`div`,oe,[f(`header`,se,[r[4]||=f(`div`,null,[f(`h1`,{class:`text-2xl font-semibold text-slate-900`},`Ask AI`),f(`p`,{class:`text-sm text-slate-500`},`Chat with the retrieval agent and get past-paper matches in-line.`)],-1),f(`div`,ce,[f(`span`,{class:u([`inline-flex items-center gap-2 rounded-full border px-3 py-1 text-xs font-semibold`,G.value])},[f(`span`,{class:u([`h-2 w-2 rounded-full`,{"bg-emerald-500":W.value===`connected`,"bg-amber-500":W.value===`connecting`,"bg-slate-400":W.value===`disconnected`}])},null,2),g(` `+b(W.value===`connected`?`Connected`:W.value===`connecting`?`Connecting`:`Disconnected`),1)],2),f(`div`,le,[r[3]||=f(`div`,{class:`font-semibold text-slate-600`},`Subscription RID`,-1),f(`code`,ue,b(wt.value),1)]),f(`div`,de,[f(`button`,{class:`btn-secondary`,disabled:E.value,onClick:J},` Reconnect `,8,fe),f(`button`,{class:`btn-tertiary`,disabled:W.value!==`connected`,onClick:jt},` Ping `,8,pe)])])]),f(`div`,me,[f(`main`,he,[f(`div`,ge,[f(`div`,{ref_key:`chatContainerRef`,ref:V,class:`chat-scroll flex h-full flex-col gap-4 overflow-y-auto px-4 py-6 md:px-10`},[z.value.length===0?(v(),h(`div`,_e,` Ask for problems by subject, board, or year to get a ranked list of questions. You can refine the results by replying with more detail. `)):(v(!0),h(a,{key:1},y(z.value,e=>(v(),h(`div`,{key:e.id,class:u([`flex`,e.role===`user`?`justify-end`:`justify-start`])},[f(`div`,{class:u([`message-bubble`,{"message-user":e.role===`user`,"message-assistant":e.role!==`user`,"message-error":e.status===`error`}])},[f(`div`,ve,[f(`span`,null,b(e.role===`user`?`You`:e.role===`assistant`?`Assistant`:`System`),1),f(`span`,ye,b(Vt(e.ts)),1),e.status===`pending`?(v(),h(`span`,be,` Searching… `)):e.status===`awaiting`?(v(),h(`span`,xe,` Needs more detail `)):e.status===`error`?(v(),h(`span`,Se,` Error `)):m(``,!0)]),f(`p`,{class:u([`mt-2 whitespace-pre-line text-sm leading-relaxed`,e.role===`user`?`text-white/95`:`text-slate-700`])},b(e.content),3),e.results?.length?(v(),h(`div`,Ce,[(v(!0),h(a,null,y(e.results,e=>(v(),h(`article`,{key:e.candidate_id||`${e.paper_code}-${e.path}`,class:`result-card`},[f(`div`,we,[f(`div`,null,[f(`p`,Te,b(e.paper_code||`Unknown paper`),1),f(`p`,Ee,b(e.path||`Path unavailable`),1)]),f(`span`,De,b(typeof e.score==`number`?e.score.toFixed(3):`—`),1)]),f(`p`,Oe,b(e.snippet||`No snippet available.`),1),f(`div`,ke,[e.year?(v(),p(l(t),{key:0,size:`small`,effect:`plain`},{default:s(()=>[g(`Year `+b(e.year),1)]),_:2},1024)):m(``,!0),e.subject?(v(),p(l(t),{key:1,size:`small`,type:`success`,effect:`plain`},{default:s(()=>[g(b(e.subject),1)]),_:2},1024)):m(``,!0),e.source?(v(),p(l(t),{key:2,size:`small`,effect:`plain`},{default:s(()=>[g(b(e.source),1)]),_:2},1024)):m(``,!0),e.exam_board?(v(),p(l(t),{key:3,size:`small`,effect:`plain`},{default:s(()=>[g(` Board `+b(e.exam_board),1)]),_:2},1024)):m(``,!0)]),e.reason?(v(),h(`p`,Ae,` Reason: `+b(e.reason),1)):m(``,!0)]))),128))])):m(``,!0)],2)],2))),128))],512)]),f(`div`,je,[K.value?(v(),h(`form`,{key:0,class:`space-y-3`,onSubmit:i(Lt,[`prevent`])},[f(`div`,Me,b(F.value||`Please provide more detail so I can continue.`),1),_(l(e),{modelValue:I.value,"onUpdate:modelValue":r[0]||=e=>I.value=e,type:`textarea`,autosize:{minRows:2,maxRows:6},placeholder:Tt.value},null,8,[`modelValue`,`placeholder`]),f(`div`,Ne,[f(`button`,{class:`btn-tertiary`,type:`button`,onClick:r[1]||=e=>I.value=``},`Clear`),f(`button`,{class:`btn-primary`,type:`submit`,disabled:!Et.value},` Send `,8,Pe)])],32)):(v(),h(`form`,{key:1,class:`space-y-3`,onSubmit:i(It,[`prevent`])},[_(l(e),{modelValue:C.value,"onUpdate:modelValue":r[2]||=e=>C.value=e,type:`textarea`,autosize:{minRows:2,maxRows:6},placeholder:Tt.value},null,8,[`modelValue`,`placeholder`]),f(`div`,Fe,[f(`div`,Ie,[(v(),h(a,null,y(x,e=>f(`button`,{key:e,class:`chip`,type:`button`,onClick:t=>Wt(e)},b(e),9,Le)),64))]),f(`div`,Re,[M.value===`running`?(v(),h(`button`,{key:0,class:`btn-tertiary`,type:`button`,disabled:!Dt.value,onClick:Mt},b(H.value?`Stopping…`:`Stop`),9,ze)):m(``,!0),f(`button`,{class:`btn-primary`,type:`submit`,disabled:!q.value},b(M.value===`running`?`Searching…`:`Send`),9,Be)])])],32)),M.value===`running`&&!K.value?(v(),h(`p`,Ve,` Searching the problem bank… `)):m(``,!0),H.value?(v(),h(`p`,He,` Stop requested. Waiting for the agent to confirm… `)):m(``,!0),L.value&&M.value===`error`?(v(),h(`p`,Ue,b(L.value),1)):m(``,!0)])]),f(`aside`,We,[f(`section`,Ge,[f(`div`,Ke,[r[5]||=f(`h2`,{class:`text-base font-semibold text-slate-900`},`Connection`,-1),f(`span`,{class:u([`badge`,G.value])},b(W.value===`connected`?`Connected`:W.value===`connecting`?`Connecting`:`Disconnected`),3)]),f(`p`,qe,b(l(R)),1),f(`div`,Je,[f(`button`,{class:`btn-secondary flex-1`,disabled:E.value,onClick:J},` Reconnect `,8,Ye),f(`button`,{class:`btn-tertiary flex-1`,disabled:W.value!==`connected`,onClick:At},` Disconnect `,8,Xe)]),L.value?(v(),h(`p`,Ze,b(L.value),1)):m(``,!0)]),f(`section`,Qe,[f(`div`,$e,[r[6]||=f(`h2`,{class:`text-base font-semibold text-slate-900`},`Session`,-1),f(`span`,et,b(Ct.value),1)]),f(`dl`,tt,[f(`div`,nt,[r[7]||=f(`dt`,{class:`font-medium text-slate-500`},`Last query`,-1),f(`dd`,rt,b(N.value||`—`),1)]),f(`div`,it,[r[8]||=f(`dt`,{class:`font-medium text-slate-500`},`Results`,-1),f(`dd`,at,b(O.value.length),1)]),A.value?(v(),h(`div`,ot,[r[9]||=f(`dt`,{class:`font-medium text-slate-500`},`Workspace`,-1),f(`dd`,st,b(A.value.total??0)+` candidates `,1)])):m(``,!0)]),k.value?(v(),h(`div`,ct,[r[10]||=f(`p`,{class:`mb-1 font-semibold text-slate-500`},`Intent blueprint`,-1),f(`ul`,lt,[(v(!0),h(a,null,y(k.value,(e,t)=>(v(),h(`li`,{key:t},[f(`span`,ut,b(t)+`:`,1),f(`span`,null,b(Array.isArray(e)?e.join(`, `):e),1)]))),128))])])):m(``,!0),j.value?(v(),h(`div`,dt,` Rerank: `+b(j.value.provider||j.value.stage||`heuristic`),1)):m(``,!0)]),f(`section`,ft,[f(`div`,pt,[r[11]||=f(`h2`,{class:`text-base font-semibold text-slate-900`},`Realtime events`,-1),f(`button`,{class:`btn-tertiary`,disabled:D.value.length===0,onClick:Ut},`Clear`,8,mt)]),f(`div`,ht,[D.value.length===0?(v(),h(`div`,gt,` Events will appear here as soon as you run a query. `)):(v(!0),h(a,{key:1},y(D.value,e=>(v(),h(`div`,{key:e.id,class:`flex gap-3 rounded-2xl border border-slate-100 bg-white px-3 py-3 shadow-sm`},[f(`div`,_t,[f(`span`,{class:u([`inline-flex h-8 w-8 items-center justify-center rounded-full border text-[11px] font-semibold`,Ht(e)])},b(e.eventType===`client`?`YOU`:e.eventType.slice(0,2).toUpperCase()),3)]),f(`div`,vt,[f(`div`,yt,[f(`p`,bt,b(e.label),1),f(`span`,xt,b(Bt(e.ts)),1)]),f(`p`,St,b(e.detail||`No additional context.`),1)])]))),128))])])])])])]))}}),w=x(C,[[`__scopeId`,`data-v-d500b1b8`]]);export{w as default};